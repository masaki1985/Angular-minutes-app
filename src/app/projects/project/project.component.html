<div *ngFor="let project of projects | async">
  <div *ngIf="project.$key === selected">
    <form>
      <div>
        <span>議題</span>
        <input type="text" value="{{project.title}}" #newTitle [readonly]="readonly">
        <button type="button" (click)="change()">変更</button>
        <button type="button" (click)="update(project, 'title', newTitle.value)">保存</button>
      </div>
      <div>
        <span>日付</span>
        <input type="date" value="{{project.date}}"#newDate (blur)="update(project, 'date', newDate.value)">
      </div>
      <div>
        <span>時間</span>
        <select #newStartTime (blur)="update(project, 'startTime', newStartTime.value)">
          <option value="00:00" [selected]="project.startTime === '00:00'">00:00</option>
          <option value="00:15" [selected]="project.startTime === '00:15'">00:15</option>
          <option value="00:30" [selected]="project.startTime === '00:30'">00:30</option>
          <option value="00:45" [selected]="project.startTime === '00:45'">00:45</option>
          <option value="01:00" [selected]="project.startTime === '01:00'">01:00</option>
        </select>
        〜
        <select #newEndTime (blur)="update(project, 'endTime', newEndTime.value)">
          <option value="00:00" [selected]="project.endTime === '00:00'">00:00</option>
          <option value="00:15" [selected]="project.endTime === '00:15'">00:15</option>
          <option value="00:30" [selected]="project.endTime === '00:30'">00:30</option>
          <option value="00:45" [selected]="project.endTime === '00:45'">00:45</option>
          <option value="01:00" [selected]="project.endTime === '01:00'">01:00</option>
        </select>
      </div>
      <div>
        <span>場所</span>
        <input type="text" value="{{project.place}}" #newPlace>
        <button type="button">変更</button>
        <button type="button" (click)="update(project, 'place', newPlace.value)">保存</button>      
      </div>
      <div>
        <span>参加者</span>
        <input type="text" #newMember>
        <button type="button" (click)="addData(project, 'members', newMember.value)">追加</button>
        <button type="button" (click)="deleteAll(project, 'members')">全削除</button>
      </div>
      <ul>
        <li *ngFor="let member of project?.members; let index = index;" class="members" draggable="true">
          <input #fixMember (blur)="updateMember(project, 'members', index, fixMember.value)" value="{{member}}">
          <button type="button" (click)="delete(project, 'members', index, fixMember.value)">×</button>
        </li>
      </ul>
      <div>
        <span>書記</span>
      </div>
      <div>
        <span>項目</span>
        <input type="text" #newItem>      
        <button type="button" (click)="updateMajorItem(project, 'items', newItem.value)">追加</button>
        <button type="button" (click)="deleteAll(project, 'items')">全削除</button>
      </div>
      <ul>
          <li *ngFor="let item of project?.items; let index = index;">
            <input type="text" value="{{item?.major}}">
            <button type="button" (click)="delete(project, 'items', index)">×</button>
            <input type="text" #newSubItem>
            <button type="button" (click)="updateSubItem(project, 'items', index, newSubItem.value)">追加</button>
            <ul *ngFor="let sub of item?.sub; let subIndex = index;">
              <li *ngIf="sub">
                <input type="text" value="{{sub}}">
                <button type="button" (click)="deleteItem(project, 'items/' + index + '/sub', index, subIndex)">×</button>
              </li>
            </ul>
          </li>
      </ul>
      <div [hidden]="hidden">
        <input type="checkbox" (click)="hide()" [checked]="checked">
        <span>サインする</span>
      </div>
    </form>
  </div>
</div>